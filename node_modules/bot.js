const Public = require('public');
const Fs = require('fs');
const Bot = require('bot');
const Discord = require('discord.js');
const ErrorMessages = require('insultes');

var reponseCmd = function(message) {
    console.log('Received: ' + message.content);

    splittedCmd = message.content.split(' ');

    if (splittedCmd[0] == '/cmd') {
        response = "";
        if (splittedCmd[1] == 'help') {
            message.channel.send(
"```Markdown\nhelp: Affiche commandes disponibles\n\
ping: Répond 'pong'\n\
link: donne le lien de l'avatar de l'auteur\n\
random <min> <max>: générer un nombre entre min et max\n\
rage: [TEST] Rage très fort et insulte méchamment\n```"
                        );

        } else if (splittedCmd[1] == 'ping') {
            response = "pong";
        
        } else if(splittedCmd[1] == 'link') {
            response = message.author.avatarURL;
        
        } else if(splittedCmd[1] == 'random') {
            if (splittedCmd.length == 4) { // La commande devrait contenir 4 éléments (/cmd random <min> <max>)
                if (Number(splittedCmd[2]) != NaN && Number(splittedCmd[3] != NaN)) {
                   response = randrange(Number(splittedCmd[2]), Number(splittedCmd[3]));
                } else {
                    response = 'ENTRE DES NOMBRES SALOPE(et pas du texte) !';
                }
            } else {
                response = 'MAIS GROS PD TU SAIS PAS ÉCRIRE OÙ QUOI ?\nSYNTAXE: /cmd random <min> <max>';
            }
        
        } else if(splittedCmd[1] == 'rage') {
            response = Bot.choisirInsulte("GENERAL");

        } else {
            response = 'MAIS ÉCRIS CORRECTEMENT GROS ENCULÉ !';
        }

        
        message.reply(response);
    }
}

var choisirInsulte = function(categorie) { //Renvoie une insulte
    if(categorie == "GENERAL") {
        return ErrorMessages["ERREURS"]["GENERAL"][randrange(0, ErrorMessages["ERREURS"]["GENERAL"].length)];
    }
}

var randrange = function(min, max) {
    return Math.floor(Math.random() * max) + min;
}

exports.choisirInsulte = choisirInsulte;
exports.reponseCmd = reponseCmd;
exports.randrange = randrange;